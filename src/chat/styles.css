/* src/chat/styles.css */
/* 基本保留原始 style.css 的内容，并做少量适应性调整 */

/* --- :root 变量定义 (保持不变) --- */
:root {
    /* 主题颜色 */
    --primary-color: #f3f4f6;
    --primary-color-light: #f3f4f6;
    --sidebar-bg: linear-gradient(180deg, var(--primary-color-light) 0%, var(--primary-color) 100%);
    /* 背景色 */
    --chat-bg: #F7F8FA;
    --container-bg: #ffffff;
    --ai-msg-bg: #F9FAFB;
    --user-msg-bg: rgb(67, 144, 253); /* 调整了用户消息背景色，更柔和 */
    --thinking-header-bg: #F3F4F6;
    /* 文本颜色 */
    --text-primary: #1F2937;
    --text-secondary: #6B7280;
    --text-tertiary: #9CA3AF;
    --text-light: #9CA3AF;
    --text-white: #ffffff;
    --text-link: #5A67EA;
    --user-msg-text: white; /* 调整了用户消息文本色 */
    --hot-list-num-color: #EF4444;
    /* 边框颜色 */
    --border-color: #E5E7EB;
    --border-color-light: #F3F4F6;
    /* 按钮和交互状态 */
    --button-primary-bg: var(--primary-color);
    --button-primary-hover-bg: 22, 119, 255;
    --new-chat-button-bg: rgba(229, 235, 247); /* 调整新建对话按钮背景更融入侧边栏 */
    --new-chat-button-hover-bg: rgba(218, 228, 247);
    --toggle-active-bg: #E0E7FF;
    --toggle-active-border: #A5B4FC;
    --toggle-active-text: #1677ff;
    /* 尺寸和阴影 */
    --border-radius-lg: 12px;
    --border-radius-md: 8px;
    --border-radius-sm: 6px;
    --box-shadow: 0 2px 8px rgba(0, 0, 0, 0.06);
    --box-shadow-lg: 0 10px 25px rgba(0, 0, 0, 0.08);
    --font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
}

/* --- 全局重置 (保持不变) --- */
* { box-sizing: border-box; margin: 0; padding: 0; }

/* --- Body (调整为适应 Next.js 应用) --- */
/* body 样式通常在 layout.tsx 或 globals.css 中设置 */
/* html, body { height: 100%; overflow: hidden; } */

/* --- 主应用容器 --- */
.app-container {
    display: flex;
    width: 100%; /* 占满视口宽度 */
    height: 91.5vh; /* 占满视口高度 */
    max-width: 100%; /* 移除最大宽度限制，由页面布局控制 */
    max-height: 100%; /* 移除最大高度限制 */
    background-color: var(--container-bg);
    /* 移除圆角和阴影，通常在内部元素或父容器上控制 */
    /* border-radius: var(--border-radius-lg); */
    /* box-shadow: var(--box-shadow-lg); */
    overflow: hidden;
    font-family: var(--font-family);
    color: var(--text-primary);
}

/* --- Sidebar --- */
.sidebar {
    width: 260px;
    background: var(--sidebar-bg);
    color: var(--text-primary);
    display: flex;
    flex-direction: column;
    padding: 15px 10px;
    flex-shrink: 0;
    transition: width 0.3s ease; /* 可选: 为侧边栏收缩添加过渡 */
}

.sidebar-header {
    padding: 10px 10px 15px 10px;
    display: flex;
    align-items: center;
    flex-wrap: wrap; /* 允许换行 */
    gap: 10px; /* 元素间距 */
}

.logo {
    font-size: 1.8em;
    font-weight: bold;
    margin-right: auto; /* 将 logo 推到左边 */
    padding-left: 5px;
}

.new-chat-btn {
    background-color: var(--new-chat-button-bg);
    color: rgb(27, 105, 254);
    border-radius: var(--border-radius-md);
    border-color: rgb(194, 214, 248);
    padding: 10px 15px;
    font-size: 0.9em;
    font-weight: bold;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: background-color 0.2s ease;
    height: 40px;
    flex-grow: 1; /* 占据剩余空间 */
    min-width: 130px; /* 避免按钮变得太小 */
}
.new-chat-btn:hover { background-color: var(--new-chat-button-hover-bg); }
.new-chat-btn .feather { margin-right: 8px; width: 16px; height: 16px; }

/* 历史记录预览 */
.history-preview {
    padding: 10px 5px 10px 10px;
    overflow-y: auto;
    flex-grow: 1;
    scrollbar-width: thin;
    scrollbar-color: rgba(255,255,255,0.3) transparent;
    margin-bottom: 10px; /* 与下方导航留出间距 */
}
.history-preview::-webkit-scrollbar { width: 5px; }
.history-preview::-webkit-scrollbar-thumb { background-color: rgba(255,255,255,0.3); border-radius: 3px; }
.history-preview::-webkit-scrollbar-track { background: transparent; }

.history-group { margin-bottom: 15px; }
.history-timeframe {
    font-size: 0.75em;
    color: black;
    padding-left: 5px;
    margin-bottom: 5px;
    display: block;
    font-weight: 500;
    text-transform: uppercase; /* 可选：时间范围大写 */
}
.history-list { list-style: none; }
.history-list li a, .history-list li button { /* 支持链接或按钮 */
    display: block;
    width: 100%; /* 占满宽度 */
    padding: 8px 10px;
    font-size: 0.88em;
    color: black;
    text-decoration: none;
    border-radius: var(--border-radius-sm);
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    transition: background-color 0.2s ease;
    text-align: left; /* 确保文本左对齐 */
    background: none; /* 重置按钮默认背景 */
    border: none; /* 重置按钮默认边框 */
    cursor: pointer; /* 统一鼠标样式 */
}
.history-list li a:hover, .history-list li button:hover {
     background-color: rgba(22, 119, 255, 0.05);
}
.history-list li.active a, .history-list li.active button { /* 当前选中的对话 */
    background-color: white;
    color: black;
    font-weight: bold;
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
}


/* 主要导航链接 */
.nav-links {
    list-style: none;
    margin-top: auto; /* 将导航推到底部 */
    padding: 10px 5px;
    flex-shrink: 0;
}
.nav-links li a {
    display: flex;
    align-items: center;
    padding: 10px 15px;
    color: black;
    text-decoration: none;
    border-radius: var(--border-radius-md);
    margin-bottom: 5px;
    transition: background-color 0.2s ease, color 0.2s ease;
    font-size: 0.95em;
}
.nav-links li a:hover { background-color: rgba(22, 119, 255, 0.1); color: rgb(22, 119, 255); }
.nav-links li.active a { background-color: rgba(22, 119, 255, 0.8); color: white; font-weight: bold; }
.nav-links li a .feather { margin-right: 12px; width: 18px; height: 18px; }

/* 侧边栏底部 */
.sidebar-footer {
    padding: 10px 10px 5px 10px;
    border-top: 1px solid black;
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-shrink: 0;
}
.sidebar-footer a, .sidebar-footer button { /* 支持链接或按钮 */
    color: black;
    text-decoration: none;
    display: flex;
    align-items: center;
    padding: 8px;
    border-radius: var(--border-radius-sm);
    transition: background-color 0.2s ease, color 0.2s ease;
    font-size: 0.85em;
    background: none; /* 重置按钮默认背景 */
    border: none; /* 重置按钮默认边框 */
    cursor: pointer; /* 统一鼠标样式 */
}
.sidebar-footer a:hover, .sidebar-footer button:hover {
    background-color: rgba(255, 255, 255, 0.1);
    color: rgb(22, 119, 255);
}
.sidebar-footer .feather { margin-right: 8px; width: 16px; height: 16px; }
.user-profile .feather { margin-right: 0; } /* 用户头像按钮不需要右边距 */

/* --- Chat Area --- */
.chat-area {
    flex-grow: 1;
    display: flex;
    flex-direction: column;
    background-color: var(--container-bg); /* 或 var(--chat-bg) 根据设计 */
    position: relative; /* 为了欢迎屏幕的绝对定位 */
    height: 100%; /* 确保聊天区域占满剩余高度 */
    overflow: hidden; /* 防止内部元素溢出 */
}

.chat-history-wrapper {
    flex-grow: 1; /* 占据可用空间 */
    overflow: hidden; /* 隐藏滚动条，由内部 chat-history 处理 */
    position: relative; /* 使得 WelcomeScreen 可以基于它定位 */
    display: flex; /* 使内部元素能正确布局 */
    flex-direction: column; /* 垂直堆叠 */
}

.chat-history {
    padding: 20px; /* 增加内边距 */
    overflow-y: auto; /* 允许内容滚动 */
    scroll-behavior: smooth;
    flex-grow: 1; /* 占据所有可用垂直空间 */
    scrollbar-width: thin;
    scrollbar-color: #d1d5db transparent;
}
.chat-history::-webkit-scrollbar { width: 6px; }
.chat-history::-webkit-scrollbar-thumb { background: #d1d5db; border-radius: 3px; }
.chat-history::-webkit-scrollbar-track { background: transparent; }

/* Welcome Screen */
.welcome-screen {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center; /* 垂直居中 */
    text-align: center;
    padding: 30px 40px;
    height: 100%; /* 占满父容器 */
    opacity: 1;
    transition: opacity 0.5s ease-out, visibility 0.5s ease-out;
    overflow: auto; /* 如果内容过多允许滚动 */
    position: absolute; /* 覆盖在 chat-history 上 */
    top: 0; left: 0; width: 100%;
    background: var(--container-bg); /* 背景与 chat-area 一致 */
    z-index: 10; /* 确保在最上层 */
    scrollbar-width: thin;
    scrollbar-color: #d1d5db transparent;
}
.welcome-screen::-webkit-scrollbar { width: 6px; }
.welcome-screen::-webkit-scrollbar-thumb { background: #d1d5db; border-radius: 3px; }
.welcome-screen::-webkit-scrollbar-track { background: transparent; }

.welcome-screen.hidden { opacity: 0; visibility: hidden; pointer-events: none; }
.welcome-header { margin-bottom: 25px; }
.welcome-logo { width: 50px; height: 50px; margin-bottom: 15px; }
.welcome-header h1 { font-size: 1.8em; font-weight: 600; margin-bottom: 8px; color: var(--text-primary); }
.welcome-header p { color: var(--text-secondary); font-size: 0.95em; }
.welcome-header a { color: var(--text-link); text-decoration: none; font-weight: 500; cursor: pointer; }
.welcome-header a:hover { text-decoration: underline; }
.welcome-header a .feather { width: 12px; height: 12px; vertical-align: middle; margin-left: 2px; }

.suggestion-cards {
    display: grid;
    /* 调整列定义以适应不同屏幕 */
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
    width: 100%;
    max-width: 1100px;
    padding: 0 10px;
}

.card {
    background-color: var(--container-bg);
    border: 1px solid var(--border-color);
    border-radius: var(--border-radius-md);
    padding: 20px;
    box-shadow: var(--box-shadow);
    text-align: left;
    display: flex;
    flex-direction: column;
    transition: box-shadow 0.2s ease, transform 0.2s ease; /* 添加 transform 过渡 */
    height: 100%; /* 确保卡片在网格中高度一致 */
}
.card:hover {
    box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    transform: translateY(-2px); /* 轻微上移效果 */
}
.card h3 { font-size: 1.05em; margin-bottom: 5px; color: var(--text-primary); font-weight: 600; }
.card p { font-size: 0.85em; color: var(--text-secondary); margin-bottom: 15px; line-height: 1.4; }
.today-hot ul { list-style: none; font-size: 0.85em; color: var(--text-secondary); }
.today-hot li { margin-bottom: 10px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; display: flex; align-items: baseline; }
.today-hot li span { font-weight: 600; margin-right: 8px; color: var(--hot-list-num-color); min-width: 15px; text-align: center; flex-shrink: 0; }
.efficiency-tools .tool-item {
    display: flex; align-items: flex-start; background-color: var(--chat-bg);
    padding: 10px 12px; border-radius: var(--border-radius-sm); margin-bottom: 10px;
    cursor: pointer; transition: background-color 0.2s ease, border-color 0.2s ease; border: 1px solid transparent;
}
.efficiency-tools .tool-item:hover { background-color: #e9ecef; border-color: rgb(160, 190, 249); }
.efficiency-tools .tool-item .feather { margin-right: 10px; width: 18px; height: 18px; color: rgb(22, 119, 255); margin-top: 2px; flex-shrink: 0; }
.efficiency-tools .tool-item div { font-size: 0.9em; color: var(--text-primary); font-weight: 500; margin-right: 5px; }
.efficiency-tools .tool-item span { display: block; font-size: 0.8em; color: var(--text-tertiary); font-weight: 400; margin-top: 2px; }
.visual-showcase .showcase-image { width: 100%; aspect-ratio: 16 / 7; background-color: #eee; border-radius: var(--border-radius-sm); overflow: hidden; margin-bottom: 15px; position: relative; }
.visual-showcase .showcase-image img { display: block; width: 100%; height: 100%; object-fit: cover; }
.try-visual-btn {
    width: 100%; padding: 10px; background-color: var(--border-color-light); border: 1px solid var(--border-color);
    border-radius: var(--border-radius-md); cursor: pointer; font-size: 0.9em; color: var(--text-primary);
    display: flex; align-items: center; justify-content: center; transition: background-color 0.2s ease;
    font-weight: 500; margin-top: auto; /* 推到底部 */ margin-bottom: 10px;
}
.try-visual-btn:hover { background-color: #e5e7eb; }
.try-visual-btn .feather { margin-right: 8px; width: 16px; height: 16px; color: var(--primary-color); }
/* Carousel dots - 保持不变，但具体实现可能需要 JS 库 */
.carousel-dots { text-align: center; margin-top: 10px; }
.carousel-dots .dot { display: inline-block; width: 6px; height: 6px; border-radius: 50%; background-color: #d1d5db; margin: 0 3px; transition: background-color 0.3s ease; cursor: pointer; }
.carousel-dots .dot.active { background-color: var(--primary-color); }

.featured-agent .agent-item {
    display: flex; align-items: center; background-color: var(--chat-bg); padding: 15px;
    border-radius: var(--border-radius-sm); cursor: pointer; transition: background-color 0.2s ease, border-color 0.2s ease; border: 1px solid transparent; margin-top: 10px; /* 与标题间距 */
}
.featured-agent .agent-item:hover { background-color: #e9ecef; border-color: var(--border-color); }
.featured-agent .agent-logo { width: 36px; height: 36px; border-radius: 8px; margin-right: 12px; flex-shrink: 0; object-fit: cover; /* 保证图片比例 */ }
.featured-agent .agent-info h4 { font-size: 0.95em; font-weight: 600; margin-bottom: 3px; color: var(--text-primary); }
.featured-agent .agent-info p { font-size: 0.8em; color: var(--text-secondary); margin-bottom: 0; line-height: 1.3; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 180px; /* 防止过长 */ }

/* Chat Message Styles */
.message {
    margin-bottom: 16px;
    display: flex;
    opacity: 0;
    animation: fadeIn 0.5s ease-out forwards;
    max-width: 85%; /* 限制最大宽度 */
    position: relative; /* 允许内部绝对定位 */
    align-items: flex-start; /* 垂直方向顶部对齐 */
}
@keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

/* User Message */
.user-message {
    justify-content: flex-end; /* 整体靠右 */
    margin-left: auto; /* 确保在右侧 */
}
.user-message .message-content-wrapper {
    display: flex; /* 内部元素 */
    flex-direction: column; /* 垂直排列 */
    align-items: flex-end; /* 内容靠右 */
}
.user-message .message-content {
    background-color: var(--user-msg-bg);
    color: var(--user-msg-text);
    border-radius: var(--border-radius-md) var(--border-radius-md) 0 var(--border-radius-md);
    padding: 12px 18px;
    word-wrap: break-word; /* 自动换行 */
    box-shadow: 0 1px 2px rgba(0,0,0,0.05); /* 细微阴影 */
    font-size: 0.95em;
    line-height: 1.6;
    white-space: pre-wrap; /* 保留空格和换行符 */
    max-width: 100%; /* 防止内容溢出父容器 */
}

/* AI Message */
.ai-message {
    justify-content: flex-start; /* 整体靠左 */
    margin-right: auto; /* 确保在左侧 */
}
.ai-icon-wrapper {
    margin-right: 12px;
    flex-shrink: 0;
    margin-top: 2px;
}
.ai-icon {
    width: 32px;
    height: 32px;
    /* 使用更柔和的渐变或单色 */
    background: linear-gradient(135deg, #a48afb 0%, #7a59f5 100%);
    color: white;
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    font-weight: bold;
    font-size: 0.8em;
}
.ai-message .message-content-wrapper {
    background-color: var(--ai-msg-bg);
    border: 1px solid var(--border-color);
    padding: 12px 18px;
    border-radius: 0 var(--border-radius-md) var(--border-radius-md) var(--border-radius-md);
    color: var(--text-primary);
    box-shadow: 0 1px 2px rgba(0,0,0,0.03);
    word-wrap: break-word;
    font-size: 0.95em;
    line-height: 1.6;
    max-width: 100%; /* 防止内容溢出父容器 */
}
.ai-message .message-content { /* AI消息的内容区，用于放置思考面板和答案 */
    white-space: pre-wrap; /* 保留格式 */
}


/* 附件样式 */
.message-attachments {
    margin-top: 10px;
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}
.attachment-item {
    display: flex;
    align-items: center;
    padding: 6px 8px; /* 调整内边距 */
    background-color: rgba(0, 0, 0, 0.03); /* 更淡的背景 */
    border-radius: var(--border-radius-sm);
    max-width: 250px; /* 限制最大宽度 */
    border: 1px solid var(--border-color-light);
}
.attachment-image {
    max-width: 150px; /* 限制图片宽度 */
    max-height: 100px; /* 限制图片高度 */
    border-radius: var(--border-radius-sm);
    object-fit: cover; /* 覆盖方式 */
    cursor: pointer; /* 可点击查看大图 */
}
.attachment-file {
    display: flex;
    align-items: center;
    gap: 6px;
}
.attachment-filename {
    font-size: 0.9em;
    color: var(--text-secondary);
    max-width: 180px; /* 文件名最大宽度 */
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
}
.attachment-item .feather {
    color: var(--text-secondary);
    width: 18px;
    height: 18px;
    flex-shrink: 0; /* 防止图标被压缩 */
}

/* Thinking Process Panel */
.thinking-process {
    margin-bottom: 10px;
    border: 1px dashed var(--border-color);
    border-radius: var(--border-radius-sm);
    background-color: rgba(243, 244, 246, 0.5); /* 半透明背景 */
    overflow: hidden;
}
.thinking-header {
    padding: 8px 12px;
    background-color: transparent; /* 移除背景色，依赖父级 */
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
    font-size: 0.85em;
    color: var(--text-secondary);
}
.thinking-header span { font-weight: 500; }
.toggle-thinking {
    background: none; border: none; cursor: pointer;
    font-size: 1.1em; line-height: 1;
    color: var(--text-light);
    transition: transform 0.3s ease;
    padding: 3px; display: flex; align-items: center; justify-content: center;
}
.toggle-thinking .feather { width: 16px; height: 16px; transition: transform 0.3s ease; }
.thinking-header[aria-expanded="true"] .toggle-thinking .feather { transform: rotate(180deg); }

.thinking-details {
    max-height: 0;
    overflow: hidden;
    padding: 0 12px;
    transition: max-height 0.4s ease-out, padding 0.4s ease-out, opacity 0.4s ease-out;
    font-size: 0.85em;
    color: var(--text-secondary);
    line-height: 1.5;
    opacity: 0;
}
.thinking-details.expanded {
    max-height: 500px; /* 足够大的最大高度 */
    padding: 10px 12px;
    opacity: 1;
}
.thinking-details p { margin-bottom: 5px; } /* 步骤间距 */

/* AI Final Answer */
.ai-answer { margin-top: 0; padding-top: 0; border-top: none; }
/* 如果思考面板存在且答案非空，则添加分割线和间距 */
.thinking-process + .ai-answer:not(:empty) {
    margin-top: 10px;
    padding-top: 10px;
    border-top: 1px solid var(--border-color-light);
}
/* 代码块样式 */
.ai-answer pre {
    background-color: #282c34; /* 更常见的暗色背景 */
    color: #abb2bf; /* 柔和的文本色 */
    padding: 15px;
    border-radius: var(--border-radius-sm);
    overflow-x: auto;
    margin: 12px 0; /* 上下边距 */
    font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace;
    font-size: 0.9em;
    line-height: 1.6; /* 增加行高 */
    box-shadow: 0 2px 4px rgba(0,0,0,0.1); /* 轻微阴影 */
}
/* 行内代码样式 */
.ai-answer code:not(pre code) {
    background-color: rgba(122, 89, 245, 0.1); /* 使用主题色相关的淡背景 */
    color: var(--primary-color); /* 使用主题色 */
    padding: 0.2em 0.5em; /* 调整内边距 */
    margin: 0 2px; /* 轻微外边距 */
    font-size: 88%; /* 稍大一点 */
    border-radius: var(--border-radius-sm);
    font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace;
}

/* --- Input Area Container --- */
.input-area-container {
    flex-shrink: 0; /* 防止被压缩 */
    background-color: transparent;
    /* 调整内边距，左右留出更多空间 */
    padding: 10px 25px 5px 25px;
    position: relative;
    margin-top: auto; /* 推到底部 */
    display: flex;
    flex-direction: column;
    align-items: center; /* 居中对齐内部元素 */
}

/* Function Toggles Styling */
.function-toggles {
    display: flex;
    gap: 10px;
    justify-content: center; /* 水平居中 */
    flex-wrap: wrap; /* 允许换行 */
    width: 100%; /* 占满容器宽度 */
    max-width: 900px; /* 限制最大宽度 */
    margin-bottom: 12px; /* 与输入框的间距 */
}
.function-toggles button {
    background-color: var(--container-bg);
    border: 1px solid var(--border-color);
    border-radius: 20px; /* 圆角 */
    padding: 6px 15px;
    font-size: 0.82em;
    color: var(--text-secondary);
    cursor: pointer;
    display: flex;
    align-items: center;
    transition: all 0.2s ease; /* 平滑过渡 */
    white-space: nowrap;
    box-shadow: 0 1px 2px rgba(0,0,0,0.04); /* 轻微阴影 */
}
.function-toggles button:hover {
    background-color: var(--chat-bg);
    border-color: #d1d5db;
    color: var(--text-primary);
    transform: translateY(-1px); /* 轻微上移 */
    box-shadow: 0 2px 4px rgba(0,0,0,0.06);
}
.function-toggles button .feather { margin-right: 6px; width: 14px; height: 14px; }
.function-toggles button.active {
    background-color: var(--toggle-active-bg);
    border-color: var(--toggle-active-border);
    color: var(--toggle-active-text);
    font-weight: 500;
    box-shadow: inset 0 1px 2px rgba(0,0,0,0.05); /* 激活状态的内阴影 */
}
.function-toggles button.active .feather { color: var(--toggle-active-text); }

/* Input Bubble Styling */
.input-area {
    display: flex;
    align-items: flex-end; /* 底部对齐 */
    padding: 8px 12px; /* 内边距 */
    background-color: var(--container-bg);
    border-radius: 24px; /* 更圆润的边角 */
    border: 1px solid var(--border-color);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.06); /* 增强阴影 */
    transition: box-shadow 0.3s ease, border-color 0.3s ease;
    position: relative;
    width: 100%;
    max-width: 900px; /* 与功能按钮区域一致 */
    min-height: 50px; /* 最小高度 */
}
.input-area:focus-within {
    box-shadow: 0 6px 20px rgba(122, 89, 245, 0.15);
    border-color: rgb(22, 119, 255, 0.8);
}

/* 输入区域左侧按钮 */
.input-buttons {
    display: flex;
    gap: 5px; /* 按钮间距 */
    margin-right: 8px; /* 与预览/输入框间距 */
    align-items: center; /* 垂直居中 */
    padding-bottom: 6px; /* 与输入框底部对齐 */
}
.input-buttons button {
    background: none; border: none; padding: 6px; cursor: pointer;
    border-radius: 50%; /* 圆形按钮 */
    color: var(--text-secondary);
    transition: all 0.2s ease;
    width: 34px; height: 34px; /* 按钮尺寸 */
    display: flex; align-items: center; justify-content: center;
}
.input-buttons button:hover {
    background-color: var(--border-color-light);
    color: var(--text-primary);
}
.input-buttons button .feather { width: 18px; height: 18px; }

/* 输入框和预览区域容器 */
.input-content {
    display: flex;
    flex-direction: column; /* 垂直排列预览和输入框 */
    flex-grow: 1; /* 占据剩余空间 */
    margin-right: 8px; /* 与发送按钮间距 */
}

/* 预览区域 */
.preview-area {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    padding-bottom: 6px; /* 与输入框间距 */
    max-height: 80px; /* 限制预览区最大高度 */
    overflow-y: auto; /* 超出高度时滚动 */
    scrollbar-width: thin;
    scrollbar-color: #d1d5db transparent;
}
.preview-area::-webkit-scrollbar { width: 4px; }
.preview-area::-webkit-scrollbar-thumb { background: #d1d5db; border-radius: 2px; }
.preview-area::-webkit-scrollbar-track { background: transparent; }

.preview-item {
    position: relative;
    max-width: 80px; /* 预览项最大宽度 */
    margin-bottom: 0; /* 移除底部外边距，由 gap 控制 */
}
.preview-item img {
    width: 100%;
    height: 50px; /* 固定高度 */
    object-fit: cover;
    border-radius: var(--border-radius-sm);
    display: block; /* 消除图片底部空白 */
    border: 1px solid var(--border-color-light); /* 细边框 */
}
.preview-item .file-preview {
    display: flex;
    align-items: center;
    padding: 6px 8px;
    background-color: var(--border-color-light);
    border-radius: var(--border-radius-sm);
    font-size: 0.8em; /* 稍小字体 */
    color: var(--text-secondary);
    max-width: 150px; /* 文件预览最大宽度 */
    height: 50px; /* 与图片高度一致 */
    box-sizing: border-box;
    overflow: hidden;
}
.preview-item .file-preview .feather { margin-right: 4px; width: 16px; height: 16px; flex-shrink: 0; }
.preview-item .file-preview span {
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.preview-item .remove-preview {
    position: absolute;
    top: -5px; right: -5px;
    background-color: rgba(0, 0, 0, 0.5); /* 半透明背景 */
    color: white;
    border: none; border-radius: 50%;
    width: 18px; height: 18px;
    font-size: 12px;
    font-weight: bold;
    display: flex; align-items: center; justify-content: center;
    cursor: pointer; padding: 0; line-height: 1;
    transition: background-color 0.2s ease;
    box-shadow: 0 1px 2px rgba(0,0,0,0.2);
}
.preview-item .remove-preview:hover { background-color: rgba(0, 0, 0, 0.7); }

/* 文本输入框 */
#user-input {
    flex-grow: 1; /* 即使没有预览也占据空间 */
    padding: 10px 0; /* 垂直内边距 */
    border: none; resize: none;
    font-size: 0.95em; line-height: 1.5;
    min-height: 24px; /* 最小高度，约等于一行 */
    max-height: 110px; /* 最大高度 */
    overflow-y: auto; /* 超出高度滚动 */
    background-color: transparent;
    color: var(--text-primary); outline: none; box-shadow: none;
    width: 100%; /* 占满 .input-content 宽度 */
    scrollbar-width: thin;
    scrollbar-color: #d1d5db transparent;
}
#user-input::-webkit-scrollbar { width: 4px; }
#user-input::-webkit-scrollbar-thumb { background: #d1d5db; border-radius: 2px; }
#user-input::-webkit-scrollbar-track { background: transparent; }
#user-input::placeholder { color: var(--text-light); }

/* 发送按钮 */
#send-button {
    /* background: linear-gradient(135deg, var(--primary-color-light), var(--primary-color)); 渐变背景 */
    background: #1677ff;
    color: var(--text-white);
    border: none; border-radius: 50%; /* 圆形 */
    width: 40px; height: 40px;
    display: flex; justify-content: center; align-items: center;
    cursor: pointer;
    transition: all 0.2s ease; /* 平滑过渡 */
    flex-shrink: 0;
    margin-bottom: 2px; /* 微调底部对齐 */
    box-shadow: 0 2px 5px rgba(122, 89, 245, 0.3); /* 添加阴影 */
}
#send-button:hover {
    transform: scale(1.05); /* 悬浮放大 */
    box-shadow: 0 4px 8px rgba(122, 89, 245, 0.4);
}
#send-button:disabled { /* 禁用状态 */
    background: #e0e0e0;
    cursor: not-allowed;
    box-shadow: none;
    transform: none;
    opacity: 0.7;
}
#send-button .feather { width: 18px; height: 18px; }

/* Footer Notice */
.footer-notice {
    font-size: 0.75em; color: var(--text-light); text-align: center;
    padding: 8px 25px 8px 25px; /* 增加底部内边距 */
    line-height: 1.4;
    background-color: transparent;
    width: 100%;
    max-width: 900px; /* 与输入区域对齐 */
}

/* 隐藏原生文件输入框 */
.hidden-file-input {
    display: none;
}

/* 确保 Feather 图标垂直居中 */
.feather {
    display: inline-block; /* 确保可以设置 vertical-align */
    vertical-align: middle;
    stroke-width: 2;
}